"use strict";

/*
 * Copyright (C) MIKO LLC - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Nikolay Beketov, 10 2020
 *
 */
var sndPlayer = {
  slider: document.getElementById('audio-player'),
  duration: 0,
  // Duration of audio clip
  $pButton: $('#play-button'),
  // play button
  $slider: $('#play-slider'),
  $playerSegment: $('#audio-player-segment'),
  initialize: function () {
    function initialize() {
      // play button event listenter
      sndPlayer.$pButton.on('click', function (e) {
        e.preventDefault();
        sndPlayer.play();
      }); // timeupdate event listener

      sndPlayer.slider.addEventListener('timeupdate', sndPlayer.cbTimeUpdate, false); // Gets audio file duration

      sndPlayer.slider.addEventListener('canplaythrough', sndPlayer.cbCanPlayThrough, false);
      sndPlayer.$slider.range({
        min: 0,
        max: 100,
        start: 0,
        onChange: sndPlayer.cbOnSliderChange
      });
    }

    return initialize;
  }(),
  UpdateSource: function () {
    function UpdateSource(newSource) {
      sndPlayer.slider.getElementsByTagName('source')[0].src = newSource;
      sndPlayer.slider.pause();
      sndPlayer.slider.load();
      sndPlayer.slider.oncanplaythrough = sndPlayer.cbCanPlayThrough;
    }

    return UpdateSource;
  }(),
  cbCanPlayThrough: function () {
    function cbCanPlayThrough() {
      sndPlayer.duration = sndPlayer.slider.duration;
      console.log("New duration ".concat(sndPlayer.slider.readyState));

      if (sndPlayer.duration > 0) {
        sndPlayer.$slider.range('set value', 0);
        sndPlayer.$playerSegment.show();
      } else {
        sndPlayer.$playerSegment.hide();
      }
    }

    return cbCanPlayThrough;
  }(),
  cbOnSliderChange: function () {
    function cbOnSliderChange(newVal, meta) {
      if (meta.triggeredByUser && Number.isFinite(sndPlayer.slider.duration)) {
        sndPlayer.slider.removeEventListener('timeupdate', sndPlayer.cbTimeUpdate, false);
        sndPlayer.slider.currentTime = sndPlayer.slider.duration * newVal / 100;
        sndPlayer.slider.addEventListener('timeupdate', sndPlayer.cbTimeUpdate, false);
      }
    }

    return cbOnSliderChange;
  }(),
  // timeUpdate
  // Synchronizes playhead position with current point in audio
  cbTimeUpdate: function () {
    function cbTimeUpdate() {
      if (Number.isFinite(sndPlayer.slider.duration)) {
        var percent = sndPlayer.slider.currentTime / sndPlayer.slider.duration;
        var rangePosition = Math.round(percent * 100);
        sndPlayer.$slider.range('set value', rangePosition);

        if (sndPlayer.slider.currentTime === sndPlayer.duration) {
          sndPlayer.$pButton.html('<i class="icon play"></i>');
        }
      }
    }

    return cbTimeUpdate;
  }(),
  // Play and Pause
  play: function () {
    function play() {
      // start music
      if (sndPlayer.slider.paused && sndPlayer.slider.duration) {
        sndPlayer.slider.play(); // remove play, add pause

        sndPlayer.$pButton.html('<i class="icon pause"></i>');
      } else {
        // pause music
        sndPlayer.slider.pause(); // remove pause, add play

        sndPlayer.$pButton.html('<i class="icon play"></i>');
      }
    }

    return play;
  }()
};
$(document).ready(function () {
  sndPlayer.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Tb3VuZEZpbGVzL3NvdW5kLWZpbGUtbW9kaWZ5LXBsYXllci5qcyJdLCJuYW1lcyI6WyJzbmRQbGF5ZXIiLCJzbGlkZXIiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZHVyYXRpb24iLCIkcEJ1dHRvbiIsIiQiLCIkc2xpZGVyIiwiJHBsYXllclNlZ21lbnQiLCJpbml0aWFsaXplIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJwbGF5IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNiVGltZVVwZGF0ZSIsImNiQ2FuUGxheVRocm91Z2giLCJyYW5nZSIsIm1pbiIsIm1heCIsInN0YXJ0Iiwib25DaGFuZ2UiLCJjYk9uU2xpZGVyQ2hhbmdlIiwiVXBkYXRlU291cmNlIiwibmV3U291cmNlIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJzcmMiLCJwYXVzZSIsImxvYWQiLCJvbmNhbnBsYXl0aHJvdWdoIiwiY29uc29sZSIsImxvZyIsInJlYWR5U3RhdGUiLCJzaG93IiwiaGlkZSIsIm5ld1ZhbCIsIm1ldGEiLCJ0cmlnZ2VyZWRCeVVzZXIiLCJOdW1iZXIiLCJpc0Zpbml0ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjdXJyZW50VGltZSIsInBlcmNlbnQiLCJyYW5nZVBvc2l0aW9uIiwiTWF0aCIsInJvdW5kIiwiaHRtbCIsInBhdXNlZCIsInJlYWR5Il0sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBUUEsSUFBTUEsU0FBUyxHQUFHO0FBQ2pCQyxFQUFBQSxNQUFNLEVBQUVDLFFBQVEsQ0FBQ0MsY0FBVCxDQUF3QixjQUF4QixDQURTO0FBRWpCQyxFQUFBQSxRQUFRLEVBQUUsQ0FGTztBQUVKO0FBQ2JDLEVBQUFBLFFBQVEsRUFBRUMsQ0FBQyxDQUFDLGNBQUQsQ0FITTtBQUdZO0FBQzdCQyxFQUFBQSxPQUFPLEVBQUVELENBQUMsQ0FBQyxjQUFELENBSk87QUFLakJFLEVBQUFBLGNBQWMsRUFBRUYsQ0FBQyxDQUFDLHVCQUFE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LENBQUNKLFFBQUQsQ0FBRCxDQUFZOEMsS0FBWixDQUFrQixZQUFNO0FBQ3ZCaEQsRUFBQUEsU0FBUyxDQUFDUyxVQUFWO0FBQ0EsQ0FGRCIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgKEMpIE1JS08gTExDIC0gQWxsIFJpZ2h0cyBSZXNlcnZlZFxuICogVW5hdXRob3JpemVkIGNvcHlpbmcgb2YgdGhpcyBmaWxlLCB2aWEgYW55IG1lZGl1bSBpcyBzdHJpY3RseSBwcm9oaWJpdGVkXG4gKiBQcm9wcmlldGFyeSBhbmQgY29uZmlkZW50aWFsXG4gKiBXcml0dGVuIGJ5IE5pa29sYXkgQmVrZXRvdiwgMTAgMjAyMFxuICpcbiAqL1xuXG5jb25zdCBzbmRQbGF5ZXIgPSB7XG5cdHNsaWRlcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F1ZGlvLXBsYXllcicpLFxuXHRkdXJhdGlvbjogMCwgLy8gRHVyYXRpb24gb2YgYXVkaW8gY2xpcFxuXHQkcEJ1dHRvbjogJCgnI3BsYXktYnV0dG9uJyksIC8vIHBsYXkgYnV0dG9uXG5cdCRzbGlkZXI6ICQoJyNwbGF5LXNsaWRlcicpLFxuXHQkcGxheWVyU2VnbWVudDogJCgnI2F1ZGlvLXBsYXllci1zZWdtZW50JyksXG5cdGluaXRpYWxpemUoKSB7XG5cdFx0Ly8gcGxheSBidXR0b24gZXZlbnQgbGlzdGVudGVyXG5cdFx0c25kUGxheWVyLiRwQnV0dG9uLm9uKCdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRzbmRQbGF5ZXIucGxheSgpO1xuXHRcdH0pO1xuXHRcdC8vIHRpbWV1cGRhdGUgZXZlbnQgbGlzdGVuZXJcblx0XHRzbmRQbGF5ZXIuc2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RpbWV1cGRhdGUnLCBzbmRQbGF5ZXIuY2JUaW1lVXBkYXRlLCBmYWxzZSk7XG5cblx0XHQvLyBHZXRzIGF1ZGlvIGZpbGUgZHVyYXRpb25cblx0XHRzbmRQbGF5ZXIuc2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgc25kUGxheWVyLmNiQ2FuUGxheVRocm91Z2gsIGZhbHNlKTtcblxuXHRcdHNuZFBsYXllci4kc2xpZGVyLnJhbmdlKHtcblx0XHRcdG1pbjogMCxcblx0XHRcdG1heDogMTAwLFxuXHRcdFx0c3RhcnQ6IDAsXG5cdFx0XHRvbkNoYW5nZTogc25kUGxheWVyLmNiT25TbGlkZXJDaGFuZ2UsXG5cdFx0fSk7XG5cdH0sXG5cdFVwZGF0ZVNvdXJjZShuZXdTb3VyY2UpIHtcblx0XHRzbmRQbGF5ZXIuc2xpZGVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzb3VyY2UnKVswXS5zcmMgPSBuZXdTb3VyY2U7XG5cdFx0c25kUGxheWVyLnNsaWRlci5wYXVzZSgpO1xuXHRcdHNuZFBsYXllci5zbGlkZXIubG9hZCgpO1xuXHRcdHNuZFBsYXllci5zbGlkZXIub25jYW5wbGF5dGhyb3VnaCA9IHNuZFBsYXllci5jYkNhblBsYXlUaHJvdWdoO1xuXHR9LFxuXHRjYkNhblBsYXlUaHJvdWdoKCkge1xuXHRcdHNuZFBsYXllci5kdXJhdGlvbiA9IHNuZFBsYXllci5zbGlkZXIuZHVyYXRpb247XG5cdFx0Y29uc29sZS5sb2coYE5ldyBkdXJhdGlvbiAke3NuZFBsYXllci5zbGlkZXIucmVhZHlTdGF0ZX1gKTtcblx0XHRpZiAoc25kUGxheWVyLmR1cmF0aW9uID4gMCkge1xuXHRcdFx0c25kUGxheWVyLiRzbGlkZXIucmFuZ2UoJ3NldCB2YWx1ZScsIDApO1xuXHRcdFx0c25kUGxheWVyLiRwbGF5ZXJTZWdtZW50LnNob3coKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c25kUGxheWVyLiRwbGF5ZXJTZWdtZW50LmhpZGUoKTtcblx0XHR9XG5cdH0sXG5cblx0Y2JPblNsaWRlckNoYW5nZShuZXdWYWwsIG1ldGEpIHtcblx0XHRpZiAobWV0YS50cmlnZ2VyZWRCeVVzZXIgJiYgTnVtYmVyLmlzRmluaXRlKHNuZFBsYXllci5zbGlkZXIuZHVyYXRpb24pKSB7XG5cdFx0XHRzbmRQbGF5ZXIuc2xpZGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RpbWV1cGRhdGUnLCBzbmRQbGF5ZXIuY2JUaW1lVXBkYXRlLCBmYWxzZSk7XG5cdFx0XHRzbmRQbGF5ZXIuc2xpZGVyLmN1cnJlbnRUaW1lID0gKHNuZFBsYXllci5zbGlkZXIuZHVyYXRpb24gKiBuZXdWYWwpIC8gMTAwO1xuXHRcdFx0c25kUGxheWVyLnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCd0aW1ldXBkYXRlJywgc25kUGxheWVyLmNiVGltZVVwZGF0ZSwgZmFsc2UpO1xuXHRcdH1cblx0fSxcblx0Ly8gdGltZVVwZGF0ZVxuXHQvLyBTeW5jaHJvbml6ZXMgcGxheWhlYWQgcG9zaXRpb24gd2l0aCBjdXJyZW50IHBvaW50IGluIGF1ZGlvXG5cdGNiVGltZVVwZGF0ZSgpIHtcblx0XHRpZiAoTnVtYmVyLmlzRmluaXRlKHNuZFBsYXllci5zbGlkZXIuZHVyYXRpb24pKSB7XG5cdFx0XHRjb25zdCBwZXJjZW50ID0gc25kUGxheWVyLnNsaWRlci5jdXJyZW50VGltZSAvIHNuZFBsYXllci5zbGlkZXIuZHVyYXRpb247XG5cdFx0XHRjb25zdCByYW5nZVBvc2l0aW9uID0gTWF0aC5yb3VuZCgocGVyY2VudCkgKiAxMDApO1xuXHRcdFx0c25kUGxheWVyLiRzbGlkZXIucmFuZ2UoJ3NldCB2YWx1ZScsIHJhbmdlUG9zaXRpb24pO1xuXHRcdFx0aWYgKHNuZFBsYXllci5zbGlkZXIuY3VycmVudFRpbWUgPT09IHNuZFBsYXllci5kdXJhdGlvbikge1xuXHRcdFx0XHRzbmRQbGF5ZXIuJHBCdXR0b24uaHRtbCgnPGkgY2xhc3M9XCJpY29uIHBsYXlcIj48L2k+Jyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8vIFBsYXkgYW5kIFBhdXNlXG5cdHBsYXkoKSB7XG5cdFx0Ly8gc3RhcnQgbXVzaWNcblx0XHRpZiAoc25kUGxheWVyLnNsaWRlci5wYXVzZWQgJiYgc25kUGxheWVyLnNsaWRlci5kdXJhdGlvbikge1xuXHRcdFx0c25kUGxheWVyLnNsaWRlci5wbGF5KCk7XG5cdFx0XHQvLyByZW1vdmUgcGxheSwgYWRkIHBhdXNlXG5cdFx0XHRzbmRQbGF5ZXIuJHBCdXR0b24uaHRtbCgnPGkgY2xhc3M9XCJpY29uIHBhdXNlXCI+PC9pPicpO1xuXHRcdH0gZWxzZSB7IC8vIHBhdXNlIG11c2ljXG5cdFx0XHRzbmRQbGF5ZXIuc2xpZGVyLnBhdXNlKCk7XG5cdFx0XHQvLyByZW1vdmUgcGF1c2UsIGFkZCBwbGF5XG5cdFx0XHRzbmRQbGF5ZXIuJHBCdXR0b24uaHRtbCgnPGkgY2xhc3M9XCJpY29uIHBsYXlcIj48L2k+Jyk7XG5cdFx0fVxuXHR9LFxuXG59O1xuXG5cbiQoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcblx0c25kUGxheWVyLmluaXRpYWxpemUoKTtcbn0pO1xuIl19