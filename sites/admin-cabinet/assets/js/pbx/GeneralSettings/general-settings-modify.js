"use strict";

/*
 * Copyright (C) MIKO LLC - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Nikolay Beketov, 12 2019
 *
 */

/* global globalRootUrl,globalTranslate, Form, PasswordScore */
var generalSettingsModify = {
  $dirrtyField: $('#dirrty'),
  $formObj: $('#general-settings-form'),
  $webAdminPassword: $('#WebAdminPassword'),
  $sshPassword: $('#SSHPassword'),
  validateRules: {
    pbxname: {
      identifier: 'PBXName',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.gs_ValidateEmptyPBXName
      }]
    },
    WebAdminPassword: {
      identifier: 'WebAdminPassword',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.gs_ValidateEmptyWebPassword
      }, {
        type: 'minLength[5]',
        prompt: globalTranslate.gs_ValidateWeakWebPassword
      }]
    },
    WebAdminPasswordRepeat: {
      identifier: 'WebAdminPasswordRepeat',
      rules: [{
        type: 'match[WebAdminPassword]',
        prompt: globalTranslate.gs_ValidateWebPasswordsFieldDifferent
      }]
    },
    SSHPassword: {
      identifier: 'SSHPassword',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.gs_ValidateEmptySSHPassword
      }, {
        type: 'minLength[5]',
        prompt: globalTranslate.gs_ValidateWeakSSHPassword
      }]
    },
    SSHPasswordRepeat: {
      identifier: 'SSHPasswordRepeat',
      rules: [{
        type: 'match[SSHPassword]',
        prompt: globalTranslate.gs_ValidateSSHPasswordsFieldDifferent
      }]
    },
    WEBPort: {
      identifier: 'WEBPort',
      rules: [{
        type: 'integer[1..65535]',
        prompt: globalTranslate.gs_ValidateWEBPortOutOfRange
      }]
    },
    WEBHTTPSPort: {
      identifier: 'WEBHTTPSPort',
      rules: [{
        type: 'integer[1..65535]',
        prompt: globalTranslate.gs_ValidateWEBHTTPSPortOutOfRange
      }, {
        type: 'different[WEBPort]',
        prompt: globalTranslate.gs_ValidateWEBHTTPSPortNotEqualToWEBPort
      }]
    }
  },
  initialize: function () {
    function initialize() {
      generalSettingsModify.$webAdminPassword.on('keyup', function () {
        PasswordScore.checkPassStrength({
          pass: generalSettingsModify.$webAdminPassword.val(),
          bar: $('.password-score'),
          section: $('.password-score-section')
        });
      });
      generalSettingsModify.$sshPassword.on('keyup', function () {
        PasswordScore.checkPassStrength({
          pass: generalSettingsModify.$sshPassword.val(),
          bar: $('.ssh-password-score'),
          section: $('.ssh-password-score-section')
        });
      });
      $('#general-settings-menu').find('.item').tab({
        history: true,
        historyType: 'hash'
      });
      $('#general-settings-form .checkbox').checkbox();
      $('#general-settings-form .dropdown').dropdown();
      $('#audio-codecs-table, #video-codecs-table').tableDnD({
        onDrop: function () {
          function onDrop() {
            generalSettingsModify.$dirrtyField.val(Math.random());
            generalSettingsModify.$dirrtyField.trigger('change');
          }

          return onDrop;
        }(),
        onDragClass: 'hoveringRow',
        dragHandle: '.dragHandle'
      });
      generalSettingsModify.initializeForm();
    }

    return initialize;
  }(),
  cbBeforeSendForm: function () {
    function cbBeforeSendForm(settings) {
      var result = settings;
      result.data = generalSettingsModify.$formObj.form('get values');
      var arrCodecs = [];
      $('#audio-codecs-table .codec-row, #video-codecs-table .codec-row').each(function (index, obj) {
        if ($(obj).attr('id')) {
          arrCodecs.push({
            codecId: $(obj).attr('id'),
            disabled: $(obj).find('.checkbox').checkbox('is unchecked'),
            priority: index
          });
        }
      });
      result.data.codecs = JSON.stringify(arrCodecs);
      return result;
    }

    return cbBeforeSendForm;
  }(),
  cbAfterSendForm: function () {
    function cbAfterSendForm() {}

    return cbAfterSendForm;
  }(),
  initializeForm: function () {
    function initializeForm() {
      Form.$formObj = generalSettingsModify.$formObj;
      Form.url = "".concat(globalRootUrl, "general-settings/save");
      Form.validateRules = generalSettingsModify.validateRules;
      Form.cbBeforeSendForm = generalSettingsModify.cbBeforeSendForm;
      Form.cbAfterSendForm = generalSettingsModify.cbAfterSendForm;
      Form.initialize();
    }

    return initializeForm;
  }()
};
$(document).ready(function () {
  generalSettingsModify.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9HZW5lcmFsU2V0dGluZ3MvZ2VuZXJhbC1zZXR0aW5ncy1tb2RpZnkuanMiXSwibmFtZXMiOlsiZ2VuZXJhbFNldHRpbmdzTW9kaWZ5IiwiJGRpcnJ0eUZpZWxkIiwiJCIsIiRmb3JtT2JqIiwiJHdlYkFkbWluUGFzc3dvcmQiLCIkc3NoUGFzc3dvcmQiLCJ2YWxpZGF0ZVJ1bGVzIiwicGJ4bmFtZSIsImlkZW50aWZpZXIiLCJydWxlcyIsInR5cGUiLCJwcm9tcHQiLCJnbG9iYWxUcmFuc2xhdGUiLCJnc19WYWxpZGF0ZUVtcHR5UEJYTmFtZSIsIldlYkFkbWluUGFzc3dvcmQiLCJnc19WYWxpZGF0ZUVtcHR5V2ViUGFzc3dvcmQiLCJnc19WYWxpZGF0ZVdlYWtXZWJQYXNzd29yZCIsIldlYkFkbWluUGFzc3dvcmRSZXBlYXQiLCJnc19WYWxpZGF0ZVdlYlBhc3N3b3Jkc0ZpZWxkRGlmZmVyZW50IiwiU1NIUGFzc3dvcmQiLCJnc19WYWxpZGF0ZUVtcHR5U1NIUGFzc3dvcmQiLCJnc19WYWxpZGF0ZVdlYWtTU0hQYXNzd29yZCIsIlNTSFBhc3N3b3JkUmVwZWF0IiwiZ3NfVmFsaWRhdGVTU0hQYXNzd29yZHNGaWVsZERpZmZlcmVudCIsIldFQlBvcnQiLCJnc19WYWxpZGF0ZVdFQlBvcnRPdXRPZlJhbmdlIiwiV0VCSFRUUFNQb3J0IiwiZ3NfVmFsaWRhdGVXRUJIVFRQU1BvcnRPdXRPZlJhbmdlIiwiZ3NfVmFsaWRhdGVXRUJIVFRQU1BvcnROb3RFcXVhbFRvV0VCUG9ydCIsImluaXRpYWxpemUiLCJvbiIsIlBhc3N3b3JkU2NvcmUiLCJjaGVja1Bhc3NTdHJlbmd0aCIsInBhc3MiLCJ2YWwiLCJiYXIiLCJzZWN0aW9uIiwiZmluZCIsInRhYiIsImhpc3RvcnkiLCJoaXN0b3J5VHlwZSIsImNoZWNrYm94IiwiZHJvcGRvd24iLCJ0YWJsZURuRCIsIm9uRHJvcCIsIk1hdGgiLCJyYW5kb20iLCJ0cmlnZ2VyIiwib25EcmFnQ2xhc3MiLCJkcmFnSGFuZGxlIiwiaW5pdGlhbGl6ZUZvcm0iLCJjYkJlZm9yZVNlbmRGb3JtIiwic2V0dGluZ3MiLCJyZXN1bHQiLCJkYXRhIiwiZm9ybSIsImFyckNvZGVjcyIsImVhY2giLCJpbmRleCIsIm9iaiIsImF0dHIiLCJwdXNoIiwiY29kZWNJZCIsImRpc2FibGVkIiwicHJpb3JpdHkiLCJjb2RlY3MiLCJKU09OIiwic3RyaW5naWZ5IiwiY2JBZnRlclNlbmRGb3JtIiwiRm9ybSIsInVybCIsImdsb2JhbFJvb3RVcmwiLCJkb2N1bWVudCIsInJlYWR5Il0sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7OztBQVNBO0FBRUEsSUFBTUEscUJBQXFCLEdBQUc7QUFDN0JDLEVBQUFBLFlBQVksRUFBRUMsQ0FBQyxDQUFDLFNBQUQsQ0FEYztBQUU3QkMsRUFBQUEsUUFBUSxFQUFFRCxDQUFDLENBQUMsd0JBQUQsQ0FGa0I7QUFHN0JFLEVBQUFBLGlCQUFpQixFQUFFRixDQUFDLENBQUMsbUJBQUQsQ0FIUztBQUk3QkcsRUFBQUEsWUFBWSxFQUFFSCxDQUFDLENBQUMsY0FBRCxDQUpjO0FBSzdCSSxFQUFBQSxhQUFhLEVBQUU7QUFDZEMsSUFBQUEsT0FBTyxFQUFFO0FBQ1JDLE1BQUFBLFVBQVUsRUFBRSxTQURKO0FBRVJDLE1BQUFBLEtBQUssRUFBRSxDQUNOO0FBQ0NDLFFBQUFBLElBQUksRUFBRSxPQURQO0FBRUNDLFFBQUFBLE1BQU0sRUFBRUMsZUFBZSxDQUFDQztBQUZ6QixPQURNO0FBRkMsS0FESztBQVVkQyxJQUFBQSxnQkFBZ0IsRUFBRTtBQUNqQk4sTUFBQUEsVUFBVSxFQUFFLGtCQURLO0FBRWpCQyxNQUFBQSxLQUFLLEVBQUUsQ0FDTjtBQUNDQyxRQUFBQSxJQUFJLEVBQUUsT0FEUDtBQUVDQyxRQUFBQSxNQUFNLEVBQUVDLGVBQWUsQ0FBQ0c7QUFGekIsT0FETSxFQUtOO0FBQ0NMLFFBQUFBLElBQUksRUFBRSxjQURQO0FBRUNDLFFBQUFBLE1BQU0sRUFBRUMsZUFBZSxDQUFDSTtBQUZ6QixPQUxN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QyxjQUFsQyxDQUZJO0FBR2R1QixZQUFBQSxRQUFRLEVBQUVOO0FBSEksV0FBZjtBQUtBO0FBQ0QsT0FSRDtBQVNBTCxNQUFBQSxNQUFNLENBQUNDLElBQVAsQ0FBWVcsTUFBWixHQUFxQkMsSUFBSSxDQUFDQyxTQUFMLENBQWVYLFNBQWYsQ0FBckI7QUFFQSxhQUFPSCxNQUFQO0FBQ0E7O0FBbEk0QjtBQUFBO0FBbUk3QmUsRUFBQUEsZUFuSTZCO0FBQUEsK0JBbUlYLENBRWpCOztBQXJJNEI7QUFBQTtBQXNJN0JsQixFQUFBQSxjQXRJNkI7QUFBQSw4QkFzSVo7QUFDaEJtQixNQUFBQSxJQUFJLENBQUNsRSxRQUFMLEdBQWdCSCxxQkFBcUIsQ0FBQ0csUUFBdEM7QUFDQWtFLE1BQUFBLElBQUksQ0FBQ0MsR0FBTCxhQUFjQyxhQUFkO0FBQ0FGLE1BQUFBLElBQUksQ0FBQy9ELGFBQUwsR0FBcUJOLHFCQUFxQixDQUFDTSxhQUEzQztBQUNBK0QsTUFBQUEsSUFBSSxDQUFDbEIsZ0JBQUwsR0FBd0JuRCxxQkFBcUIsQ0FBQ21ELGdCQUE5QztBQUNBa0IsTUFBQUEsSUFBSSxDQUFDRCxlQUFMLEdBQXVCcEUscUJBQXFCLENBQUNvRSxlQUE3QztBQUNBQyxNQUFBQSxJQUFJLENBQUN4QyxVQUFMO0FBQ0E7O0FBN0k0QjtBQUFBO0FBQUEsQ0FBOUI7QUFnSkEzQixDQUFDLENBQUNzRSxRQUFELENBQUQsQ0FBWUMsS0FBWixDQUFrQixZQUFNO0FBQ3ZCekUsRUFBQUEscUJBQXFCLENBQUM2QixVQUF0QjtBQUNBLENBRkQiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IChDKSBNSUtPIExMQyAtIEFsbCBSaWdodHMgUmVzZXJ2ZWRcbiAqIFVuYXV0aG9yaXplZCBjb3B5aW5nIG9mIHRoaXMgZmlsZSwgdmlhIGFueSBtZWRpdW0gaXMgc3RyaWN0bHkgcHJvaGliaXRlZFxuICogUHJvcHJpZXRhcnkgYW5kIGNvbmZpZGVudGlhbFxuICogV3JpdHRlbiBieSBOaWtvbGF5IEJla2V0b3YsIDEyIDIwMTlcbiAqXG4gKi9cblxuXG4vKiBnbG9iYWwgZ2xvYmFsUm9vdFVybCxnbG9iYWxUcmFuc2xhdGUsIEZvcm0sIFBhc3N3b3JkU2NvcmUgKi9cblxuY29uc3QgZ2VuZXJhbFNldHRpbmdzTW9kaWZ5ID0ge1xuXHQkZGlycnR5RmllbGQ6ICQoJyNkaXJydHknKSxcblx0JGZvcm1PYmo6ICQoJyNnZW5lcmFsLXNldHRpbmdzLWZvcm0nKSxcblx0JHdlYkFkbWluUGFzc3dvcmQ6ICQoJyNXZWJBZG1pblBhc3N3b3JkJyksXG5cdCRzc2hQYXNzd29yZDogJCgnI1NTSFBhc3N3b3JkJyksXG5cdHZhbGlkYXRlUnVsZXM6IHtcblx0XHRwYnhuYW1lOiB7XG5cdFx0XHRpZGVudGlmaWVyOiAnUEJYTmFtZScsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2VtcHR5Jyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5nc19WYWxpZGF0ZUVtcHR5UEJYTmFtZSxcblx0XHRcdFx0fSxcblx0XHRcdF0sXG5cdFx0fSxcblx0XHRXZWJBZG1pblBhc3N3b3JkOiB7XG5cdFx0XHRpZGVudGlmaWVyOiAnV2ViQWRtaW5QYXNzd29yZCcsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2VtcHR5Jyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5nc19WYWxpZGF0ZUVtcHR5V2ViUGFzc3dvcmQsXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0eXBlOiAnbWluTGVuZ3RoWzVdJyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5nc19WYWxpZGF0ZVdlYWtXZWJQYXNzd29yZCxcblx0XHRcdFx0fSxcblx0XHRcdF0sXG5cdFx0fSxcblx0XHRXZWJBZG1pblBhc3N3b3JkUmVwZWF0OiB7XG5cdFx0XHRpZGVudGlmaWVyOiAnV2ViQWRtaW5QYXNzd29yZFJlcGVhdCcsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ21hdGNoW1dlYkFkbWluUGFzc3dvcmRdJyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5nc19WYWxpZGF0ZVdlYlBhc3N3b3Jkc0ZpZWxkRGlmZmVyZW50LFxuXHRcdFx0XHR9LFxuXHRcdFx0XSxcblx0XHR9LFxuXHRcdFNTSFBhc3N3b3JkOiB7XG5cdFx0XHRpZGVudGlmaWVyOiAnU1NIUGFzc3dvcmQnLFxuXHRcdFx0cnVsZXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6ICdlbXB0eScsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUuZ3NfVmFsaWRhdGVFbXB0eVNTSFBhc3N3b3JkLFxuXHRcdFx0XHR9LFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ21pbkxlbmd0aFs1XScsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUuZ3NfVmFsaWRhdGVXZWFrU1NIUGFzc3dvcmQsXG5cdFx0XHRcdH0sXG5cdFx0XHRdLFxuXHRcdH0sXG5cdFx0U1NIUGFzc3dvcmRSZXBlYXQ6IHtcblx0XHRcdGlkZW50aWZpZXI6ICdTU0hQYXNzd29yZFJlcGVhdCcsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ21hdGNoW1NTSFBhc3N3b3JkXScsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUuZ3NfVmFsaWRhdGVTU0hQYXNzd29yZHNGaWVsZERpZmZlcmVudCxcblx0XHRcdFx0fSxcblx0XHRcdF0sXG5cdFx0fSxcblx0XHRXRUJQb3J0OiB7XG5cdFx0XHRpZGVudGlmaWVyOiAnV0VCUG9ydCcsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2ludGVnZXJbMS4uNjU1MzVdJyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5nc19WYWxpZGF0ZVdFQlBvcnRPdXRPZlJhbmdlLFxuXHRcdFx0XHR9LFxuXHRcdFx0XSxcblx0XHR9LFxuXHRcdFdFQkhUVFBTUG9ydDoge1xuXHRcdFx0aWRlbnRpZmllcjogJ1dFQkhUVFBTUG9ydCcsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2ludGVnZXJbMS4uNjU1MzVdJyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5nc19WYWxpZGF0ZVdFQkhUVFBTUG9ydE91dE9mUmFuZ2UsXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0eXBlOiAnZGlmZmVyZW50W1dFQlBvcnRdJyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5nc19WYWxpZGF0ZVdFQkhUVFBTUG9ydE5vdEVxdWFsVG9XRUJQb3J0LFxuXHRcdFx0XHR9LFxuXHRcdFx0XSxcblx0XHR9LFxuXHR9LFxuXHRpbml0aWFsaXplKCkge1xuXHRcdGdlbmVyYWxTZXR0aW5nc01vZGlmeS4kd2ViQWRtaW5QYXNzd29yZC5vbigna2V5dXAnLCAoKSA9PiB7XG5cdFx0XHRQYXNzd29yZFNjb3JlLmNoZWNrUGFzc1N0cmVuZ3RoKHtcblx0XHRcdFx0cGFzczogZ2VuZXJhbFNldHRpbmdzTW9kaWZ5LiR3ZWJBZG1pblBhc3N3b3JkLnZhbCgpLFxuXHRcdFx0XHRiYXI6ICQoJy5wYXNzd29yZC1zY29yZScpLFxuXHRcdFx0XHRzZWN0aW9uOiAkKCcucGFzc3dvcmQtc2NvcmUtc2VjdGlvbicpLFxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdFx0Z2VuZXJhbFNldHRpbmdzTW9kaWZ5LiRzc2hQYXNzd29yZC5vbigna2V5dXAnLCAoKSA9PiB7XG5cdFx0XHRQYXNzd29yZFNjb3JlLmNoZWNrUGFzc1N0cmVuZ3RoKHtcblx0XHRcdFx0cGFzczogZ2VuZXJhbFNldHRpbmdzTW9kaWZ5LiRzc2hQYXNzd29yZC52YWwoKSxcblx0XHRcdFx0YmFyOiAkKCcuc3NoLXBhc3N3b3JkLXNjb3JlJyksXG5cdFx0XHRcdHNlY3Rpb246ICQoJy5zc2gtcGFzc3dvcmQtc2NvcmUtc2VjdGlvbicpLFxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdFx0JCgnI2dlbmVyYWwtc2V0dGluZ3MtbWVudScpLmZpbmQoJy5pdGVtJykudGFiKHtcblx0XHRcdGhpc3Rvcnk6IHRydWUsXG5cdFx0XHRoaXN0b3J5VHlwZTogJ2hhc2gnLFxuXHRcdH0pO1xuXHRcdCQoJyNnZW5lcmFsLXNldHRpbmdzLWZvcm0gLmNoZWNrYm94JykuY2hlY2tib3goKTtcblx0XHQkKCcjZ2VuZXJhbC1zZXR0aW5ncy1mb3JtIC5kcm9wZG93bicpLmRyb3Bkb3duKCk7XG5cblx0XHQkKCcjYXVkaW8tY29kZWNzLXRhYmxlLCAjdmlkZW8tY29kZWNzLXRhYmxlJykudGFibGVEbkQoe1xuXHRcdFx0b25Ecm9wKCkge1xuXHRcdFx0XHRnZW5lcmFsU2V0dGluZ3NNb2RpZnkuJGRpcnJ0eUZpZWxkLnZhbChNYXRoLnJhbmRvbSgpKTtcblx0XHRcdFx0Z2VuZXJhbFNldHRpbmdzTW9kaWZ5LiRkaXJydHlGaWVsZC50cmlnZ2VyKCdjaGFuZ2UnKTtcblx0XHRcdH0sXG5cdFx0XHRvbkRyYWdDbGFzczogJ2hvdmVyaW5nUm93Jyxcblx0XHRcdGRyYWdIYW5kbGU6ICcuZHJhZ0hhbmRsZScsXG5cdFx0fSk7XG5cdFx0Z2VuZXJhbFNldHRpbmdzTW9kaWZ5LmluaXRpYWxpemVGb3JtKCk7XG5cdH0sXG5cdGNiQmVmb3JlU2VuZEZvcm0oc2V0dGluZ3MpIHtcblx0XHRjb25zdCByZXN1bHQgPSBzZXR0aW5ncztcblx0XHRyZXN1bHQuZGF0YSA9IGdlbmVyYWxTZXR0aW5nc01vZGlmeS4kZm9ybU9iai5mb3JtKCdnZXQgdmFsdWVzJyk7XG5cdFx0Y29uc3QgYXJyQ29kZWNzID0gW107XG5cdFx0JCgnI2F1ZGlvLWNvZGVjcy10YWJsZSAuY29kZWMtcm93LCAjdmlkZW8tY29kZWNzLXRhYmxlIC5jb2RlYy1yb3cnKS5lYWNoKChpbmRleCwgb2JqKSA9PiB7XG5cdFx0XHRpZiAoJChvYmopLmF0dHIoJ2lkJykpIHtcblx0XHRcdFx0YXJyQ29kZWNzLnB1c2goe1xuXHRcdFx0XHRcdGNvZGVjSWQ6ICQob2JqKS5hdHRyKCdpZCcpLFxuXHRcdFx0XHRcdGRpc2FibGVkOiAkKG9iaikuZmluZCgnLmNoZWNrYm94JykuY2hlY2tib3goJ2lzIHVuY2hlY2tlZCcpLFxuXHRcdFx0XHRcdHByaW9yaXR5OiBpbmRleCxcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmVzdWx0LmRhdGEuY29kZWNzID0gSlNPTi5zdHJpbmdpZnkoYXJyQ29kZWNzKTtcblxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sXG5cdGNiQWZ0ZXJTZW5kRm9ybSgpIHtcblxuXHR9LFxuXHRpbml0aWFsaXplRm9ybSgpIHtcblx0XHRGb3JtLiRmb3JtT2JqID0gZ2VuZXJhbFNldHRpbmdzTW9kaWZ5LiRmb3JtT2JqO1xuXHRcdEZvcm0udXJsID0gYCR7Z2xvYmFsUm9vdFVybH1nZW5lcmFsLXNldHRpbmdzL3NhdmVgO1xuXHRcdEZvcm0udmFsaWRhdGVSdWxlcyA9IGdlbmVyYWxTZXR0aW5nc01vZGlmeS52YWxpZGF0ZVJ1bGVzO1xuXHRcdEZvcm0uY2JCZWZvcmVTZW5kRm9ybSA9IGdlbmVyYWxTZXR0aW5nc01vZGlmeS5jYkJlZm9yZVNlbmRGb3JtO1xuXHRcdEZvcm0uY2JBZnRlclNlbmRGb3JtID0gZ2VuZXJhbFNldHRpbmdzTW9kaWZ5LmNiQWZ0ZXJTZW5kRm9ybTtcblx0XHRGb3JtLmluaXRpYWxpemUoKTtcblx0fSxcbn07XG5cbiQoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcblx0Z2VuZXJhbFNldHRpbmdzTW9kaWZ5LmluaXRpYWxpemUoKTtcbn0pOyJdfQ==